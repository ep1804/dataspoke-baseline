-- 02_orders.sql — UC3, UC5, UC7: order items, fulfillment summary, raw events, EU purchase history.

-- Order items (80 rows) — FK to catalog.editions for UC7 join path
CREATE TABLE orders.order_items (
    item_id       SERIAL PRIMARY KEY,
    order_id      VARCHAR(20) NOT NULL,
    edition_id    INTEGER NOT NULL,
    quantity      INTEGER NOT NULL DEFAULT 1,
    unit_price    NUMERIC(10,2) NOT NULL,
    discount_pct  NUMERIC(5,2) DEFAULT 0,
    ordered_at    TIMESTAMP NOT NULL,
    status        VARCHAR(20) DEFAULT 'confirmed' CHECK (status IN ('placed','confirmed','shipped','delivered','cancelled'))
);

-- 80 order items referencing edition_ids 1-40
INSERT INTO orders.order_items (order_id, edition_id, quantity, unit_price, discount_pct, ordered_at, status) VALUES
('ORD-2024-00001', 1,  1, 24.99, 0,    '2024-11-01 09:12:00', 'delivered'),
('ORD-2024-00001', 4,  1, 9.99,  0,    '2024-11-01 09:12:00', 'delivered'),
('ORD-2024-00002', 5,  1, 13.99, 5.00, '2024-11-02 14:30:00', 'delivered'),
('ORD-2024-00003', 7,  1, 28.99, 0,    '2024-11-03 11:45:00', 'delivered'),
('ORD-2024-00003', 9,  1, 11.99, 0,    '2024-11-03 11:45:00', 'delivered'),
('ORD-2024-00004', 10, 1, 32.99, 10.00,'2024-11-04 08:20:00', 'delivered'),
('ORD-2024-00005', 11, 1, 29.99, 0,    '2024-11-05 16:55:00', 'delivered'),
('ORD-2024-00006', 2,  2, 14.99, 0,    '2024-11-06 10:10:00', 'delivered'),
('ORD-2024-00007', 14, 1, 9.99,  0,    '2024-11-07 13:22:00', 'delivered'),
('ORD-2024-00008', 15, 1, 15.99, 0,    '2024-11-08 09:30:00', 'delivered'),
('ORD-2024-00008', 16, 1, 8.99,  0,    '2024-11-08 09:30:00', 'delivered'),
('ORD-2024-00009', 17, 1, 12.99, 0,    '2024-11-09 15:40:00', 'shipped'),
('ORD-2024-00010', 3,  1, 26.99, 0,    '2024-11-10 11:05:00', 'delivered'),
('ORD-2024-00011', 18, 1, 14.99, 0,    '2024-11-11 08:15:00', 'delivered'),
('ORD-2024-00011', 19, 1, 17.99, 0,    '2024-11-11 08:15:00', 'delivered'),
('ORD-2024-00012', 20, 1, 28.99, 5.00, '2024-11-12 14:50:00', 'delivered'),
('ORD-2024-00013', 21, 1, 14.99, 0,    '2024-11-13 10:30:00', 'delivered'),
('ORD-2024-00014', 22, 1, 25.99, 0,    '2024-11-14 09:45:00', 'delivered'),
('ORD-2024-00014', 23, 1, 10.99, 0,    '2024-11-14 09:45:00', 'delivered'),
('ORD-2024-00015', 24, 1, 27.99, 0,    '2024-11-15 16:20:00', 'shipped'),
('ORD-2024-00016', 25, 1, 10.99, 0,    '2024-11-16 12:10:00', 'delivered'),
('ORD-2024-00017', 26, 1, 28.99, 0,    '2024-11-17 08:55:00', 'delivered'),
('ORD-2024-00017', 27, 1, 13.99, 0,    '2024-11-17 08:55:00', 'delivered'),
('ORD-2024-00018', 28, 1, 31.99, 10.00,'2024-11-18 14:35:00', 'delivered'),
('ORD-2024-00019', 29, 1, 13.99, 0,    '2024-11-19 11:20:00', 'delivered'),
('ORD-2024-00020', 30, 1, 11.99, 0,    '2024-11-20 09:00:00', 'delivered'),
('ORD-2024-00021', 31, 1, 29.99, 0,    '2024-11-21 15:45:00', 'delivered'),
('ORD-2024-00022', 32, 1, 29.99, 5.00, '2024-11-22 10:15:00', 'delivered'),
('ORD-2024-00022', 33, 1, 12.99, 0,    '2024-11-22 10:15:00', 'delivered'),
('ORD-2024-00023', 34, 1, 14.99, 0,    '2024-11-23 13:40:00', 'delivered'),
('ORD-2024-00024', 35, 1, 26.99, 0,    '2024-11-24 08:30:00', 'shipped'),
('ORD-2024-00025', 36, 1, 34.99, 0,    '2024-11-25 16:10:00', 'delivered'),
('ORD-2024-00026', 37, 1, 17.99, 0,    '2024-11-26 11:55:00', 'delivered'),
('ORD-2024-00027', 38, 1, 14.99, 0,    '2024-11-27 09:25:00', 'delivered'),
('ORD-2024-00028', 39, 1, 10.99, 0,    '2024-11-28 14:00:00', 'delivered'),
('ORD-2024-00029', 40, 1, 28.99, 0,    '2024-11-29 10:45:00', 'confirmed'),
('ORD-2024-00030', 1,  1, 24.99, 0,    '2024-11-30 08:00:00', 'delivered'),
('ORD-2024-00030', 8,  1, 18.99, 0,    '2024-11-30 08:00:00', 'delivered'),
('ORD-2024-00031', 12, 1, 14.99, 0,    '2024-12-01 09:15:00', 'delivered'),
('ORD-2024-00031', 6,  1, 19.99, 10.00,'2024-12-01 09:15:00', 'delivered'),
('ORD-2024-00032', 13, 1, 17.99, 0,    '2024-12-02 11:30:00', 'delivered'),
('ORD-2024-00033', 1,  2, 24.99, 0,    '2024-12-03 14:20:00', 'delivered'),
('ORD-2024-00034', 3,  1, 26.99, 5.00, '2024-12-04 08:45:00', 'delivered'),
('ORD-2024-00035', 7,  1, 28.99, 0,    '2024-12-05 12:00:00', 'shipped'),
('ORD-2024-00036', 11, 1, 29.99, 0,    '2024-12-06 15:30:00', 'delivered'),
('ORD-2024-00036', 15, 1, 15.99, 0,    '2024-12-06 15:30:00', 'delivered'),
('ORD-2024-00037', 20, 1, 28.99, 0,    '2024-12-07 10:00:00', 'delivered'),
('ORD-2024-00038', 22, 1, 25.99, 0,    '2024-12-08 09:10:00', 'delivered'),
('ORD-2024-00039', 24, 1, 27.99, 0,    '2024-12-09 13:45:00', 'placed'),
('ORD-2024-00040', 26, 1, 28.99, 0,    '2024-12-10 11:20:00', 'delivered'),
('ORD-2024-00040', 31, 1, 29.99, 5.00, '2024-12-10 11:20:00', 'delivered'),
('ORD-2024-00041', 32, 1, 29.99, 0,    '2024-12-11 08:30:00', 'delivered'),
('ORD-2024-00042', 35, 1, 26.99, 0,    '2024-12-12 14:15:00', 'delivered'),
('ORD-2024-00043', 36, 1, 34.99, 10.00,'2024-12-13 16:00:00', 'delivered'),
('ORD-2024-00044', 38, 1, 14.99, 0,    '2024-12-14 09:50:00', 'delivered'),
('ORD-2024-00045', 40, 1, 28.99, 0,    '2024-12-15 11:35:00', 'confirmed'),
('ORD-2024-00046', 2,  1, 14.99, 0,    '2024-12-16 08:20:00', 'delivered'),
('ORD-2024-00047', 5,  1, 13.99, 0,    '2024-12-17 13:00:00', 'delivered'),
('ORD-2024-00048', 10, 1, 32.99, 0,    '2024-12-18 15:45:00', 'delivered'),
('ORD-2024-00049', 14, 1, 9.99,  5.00, '2024-12-19 10:30:00', 'delivered'),
('ORD-2024-00050', 17, 1, 12.99, 0,    '2024-12-20 09:00:00', 'shipped'),
('ORD-2024-00051', 21, 1, 14.99, 0,    '2024-12-21 14:10:00', 'delivered'),
('ORD-2024-00052', 25, 1, 10.99, 0,    '2024-12-22 11:25:00', 'delivered'),
('ORD-2024-00053', 28, 1, 31.99, 0,    '2024-12-23 08:45:00', 'delivered'),
('ORD-2024-00054', 30, 1, 11.99, 0,    '2024-12-24 16:30:00', 'delivered'),
('ORD-2024-00055', 33, 1, 12.99, 0,    '2024-12-25 10:00:00', 'delivered'),
('ORD-2024-00056', 34, 1, 14.99, 0,    '2024-12-26 12:15:00', 'delivered'),
('ORD-2024-00057', 37, 1, 17.99, 0,    '2024-12-27 09:40:00', 'delivered'),
('ORD-2024-00058', 39, 1, 10.99, 5.00, '2024-12-28 14:50:00', 'delivered'),
('ORD-2024-00059', 1,  1, 24.99, 0,    '2024-12-29 11:00:00', 'confirmed'),
('ORD-2024-00059', 4,  1, 9.99,  0,    '2024-12-29 11:00:00', 'confirmed'),
('ORD-2024-00060', 8,  1, 18.99, 0,    '2024-12-30 08:15:00', 'placed'),
('ORD-2024-00060', 9,  2, 11.99, 0,    '2024-12-30 08:15:00', 'placed'),
('ORD-2024-00061', 12, 1, 14.99, 0,    '2024-12-31 13:30:00', 'delivered'),
('ORD-2024-00062', 16, 1, 8.99,  0,    '2025-01-01 10:20:00', 'delivered'),
('ORD-2024-00063', 19, 1, 17.99, 0,    '2025-01-02 15:00:00', 'shipped'),
('ORD-2024-00064', 23, 1, 10.99, 0,    '2025-01-03 09:30:00', 'delivered'),
('ORD-2024-00065', 27, 1, 13.99, 0,    '2025-01-04 12:45:00', 'delivered'),
('ORD-2024-00066', 29, 1, 13.99, 0,    '2025-01-05 08:10:00', 'delivered'),
('ORD-2024-00067', 36, 1, 34.99, 0,    '2025-01-06 14:25:00', 'confirmed');

-- Daily fulfillment summary (30 rows, 1 anomalous day for UC3 SLA detection)
CREATE TABLE orders.daily_fulfillment_summary (
    summary_date    DATE PRIMARY KEY,
    row_count       INTEGER NOT NULL,
    total_revenue   NUMERIC(12,2) NOT NULL,
    avg_items_per_order NUMERIC(5,2),
    created_at      TIMESTAMP DEFAULT NOW()
);

INSERT INTO orders.daily_fulfillment_summary (summary_date, row_count, total_revenue, avg_items_per_order) VALUES
('2025-01-01', 142, 3245.80, 1.8),
('2025-01-02', 138, 3102.50, 1.7),
('2025-01-03', 155, 3580.20, 1.9),
('2025-01-04', 148, 3390.10, 1.8),
('2025-01-05', 160, 3720.60, 2.0),
('2025-01-06', 145, 3310.40, 1.8),
('2025-01-07', 152, 3490.30, 1.9),
('2025-01-08', 140, 3200.90, 1.7),
('2025-01-09', 158, 3650.70, 1.9),
('2025-01-10', 143, 3280.20, 1.8),
('2025-01-11', 150, 3450.50, 1.8),
('2025-01-12', 147, 3370.80, 1.8),
('2025-01-13', 156, 3590.40, 1.9),
('2025-01-14', 141, 3230.60, 1.7),
('2025-01-15',  12,  275.88, 1.0),  -- ← anomalous low-volume day (UC3 SLA)
('2025-01-16', 153, 3520.10, 1.9),
('2025-01-17', 149, 3410.70, 1.8),
('2025-01-18', 161, 3740.30, 2.0),
('2025-01-19', 144, 3300.90, 1.8),
('2025-01-20', 157, 3620.50, 1.9),
('2025-01-21', 146, 3350.20, 1.8),
('2025-01-22', 151, 3470.80, 1.9),
('2025-01-23', 139, 3180.40, 1.7),
('2025-01-24', 154, 3550.60, 1.9),
('2025-01-25', 148, 3400.30, 1.8),
('2025-01-26', 159, 3680.90, 2.0),
('2025-01-27', 142, 3260.50, 1.8),
('2025-01-28', 155, 3570.20, 1.9),
('2025-01-29', 147, 3380.70, 1.8),
('2025-01-30', 150, 3440.10, 1.8);

-- Raw order events (100 rows) — event stream for UC3
CREATE TABLE orders.raw_events (
    event_id    SERIAL PRIMARY KEY,
    order_id    VARCHAR(20) NOT NULL,
    event_type  VARCHAR(20) NOT NULL CHECK (event_type IN ('placed','confirmed','shipped','delivered','cancelled')),
    event_ts    TIMESTAMP NOT NULL,
    payload     JSONB,
    created_at  TIMESTAMP DEFAULT NOW()
);

-- Generate 100 lifecycle events across 25 orders (4 events each: placed → confirmed → shipped → delivered)
INSERT INTO orders.raw_events (order_id, event_type, event_ts, payload) VALUES
('ORD-2024-00001', 'placed',    '2024-11-01 09:12:00', '{"items":2,"total":34.98}'),
('ORD-2024-00001', 'confirmed', '2024-11-01 09:15:00', '{"warehouse":"WH-East"}'),
('ORD-2024-00001', 'shipped',   '2024-11-02 08:00:00', '{"carrier":"UPS","tracking":"1Z999AA10001"}'),
('ORD-2024-00001', 'delivered', '2024-11-04 14:30:00', '{"signed_by":"E. Smith"}'),
('ORD-2024-00002', 'placed',    '2024-11-02 14:30:00', '{"items":1,"total":13.29}'),
('ORD-2024-00002', 'confirmed', '2024-11-02 14:35:00', '{"warehouse":"WH-West"}'),
('ORD-2024-00002', 'shipped',   '2024-11-03 10:00:00', '{"carrier":"FedEx","tracking":"FX100200300"}'),
('ORD-2024-00002', 'delivered', '2024-11-05 11:00:00', '{"signed_by":"M. Jones"}'),
('ORD-2024-00003', 'placed',    '2024-11-03 11:45:00', '{"items":2,"total":40.98}'),
('ORD-2024-00003', 'confirmed', '2024-11-03 11:50:00', '{"warehouse":"WH-East"}'),
('ORD-2024-00003', 'shipped',   '2024-11-04 09:00:00', '{"carrier":"DHL","tracking":"DH5001001"}'),
('ORD-2024-00003', 'delivered', '2024-11-06 16:20:00', '{"signed_by":"A. Weber"}'),
('ORD-2024-00004', 'placed',    '2024-11-04 08:20:00', '{"items":1,"total":29.69}'),
('ORD-2024-00004', 'confirmed', '2024-11-04 08:25:00', '{"warehouse":"WH-East"}'),
('ORD-2024-00004', 'shipped',   '2024-11-05 07:30:00', '{"carrier":"UPS","tracking":"1Z999AA10002"}'),
('ORD-2024-00004', 'delivered', '2024-11-07 13:45:00', '{"signed_by":"L. Kim"}'),
('ORD-2024-00005', 'placed',    '2024-11-05 16:55:00', '{"items":1,"total":29.99}'),
('ORD-2024-00005', 'confirmed', '2024-11-05 17:00:00', '{"warehouse":"WH-West"}'),
('ORD-2024-00005', 'shipped',   '2024-11-06 08:15:00', '{"carrier":"FedEx","tracking":"FX100200301"}'),
('ORD-2024-00005', 'delivered', '2024-11-08 10:30:00', '{"signed_by":"T. Nguyen"}'),
('ORD-2024-00006', 'placed',    '2024-11-06 10:10:00', '{"items":2,"total":29.98}'),
('ORD-2024-00006', 'confirmed', '2024-11-06 10:15:00', '{"warehouse":"WH-East"}'),
('ORD-2024-00006', 'shipped',   '2024-11-07 09:00:00', '{"carrier":"UPS","tracking":"1Z999AA10003"}'),
('ORD-2024-00006', 'delivered', '2024-11-09 15:10:00', '{"signed_by":"R. Garcia"}'),
('ORD-2024-00007', 'placed',    '2024-11-07 13:22:00', '{"items":1,"total":9.99}'),
('ORD-2024-00007', 'confirmed', '2024-11-07 13:25:00', '{"warehouse":"WH-West"}'),
('ORD-2024-00007', 'shipped',   '2024-11-08 07:45:00', '{"carrier":"DHL","tracking":"DH5001002"}'),
('ORD-2024-00007', 'delivered', '2024-11-10 12:00:00', '{"signed_by":"S. Müller"}'),
('ORD-2024-00008', 'placed',    '2024-11-08 09:30:00', '{"items":2,"total":24.98}'),
('ORD-2024-00008', 'confirmed', '2024-11-08 09:35:00', '{"warehouse":"WH-East"}'),
('ORD-2024-00008', 'shipped',   '2024-11-09 08:00:00', '{"carrier":"FedEx","tracking":"FX100200302"}'),
('ORD-2024-00008', 'delivered', '2024-11-11 14:20:00', '{"signed_by":"J. Park"}'),
('ORD-2024-00009', 'placed',    '2024-11-09 15:40:00', '{"items":1,"total":12.99}'),
('ORD-2024-00009', 'confirmed', '2024-11-09 15:45:00', '{"warehouse":"WH-East"}'),
('ORD-2024-00009', 'shipped',   '2024-11-10 09:30:00', '{"carrier":"UPS","tracking":"1Z999AA10004"}'),
('ORD-2024-00009', 'delivered', '2024-11-12 11:15:00', '{"signed_by":"C. Rossi"}'),
('ORD-2024-00010', 'placed',    '2024-11-10 11:05:00', '{"items":1,"total":26.99}'),
('ORD-2024-00010', 'confirmed', '2024-11-10 11:10:00', '{"warehouse":"WH-West"}'),
('ORD-2024-00010', 'shipped',   '2024-11-11 08:00:00', '{"carrier":"DHL","tracking":"DH5001003"}'),
('ORD-2024-00010', 'delivered', '2024-11-13 16:45:00', '{"signed_by":"M. Schmidt"}'),
('ORD-2024-00011', 'placed',    '2024-11-11 08:15:00', '{"items":2,"total":32.98}'),
('ORD-2024-00011', 'confirmed', '2024-11-11 08:20:00', '{"warehouse":"WH-East"}'),
('ORD-2024-00011', 'shipped',   '2024-11-12 07:30:00', '{"carrier":"UPS","tracking":"1Z999AA10005"}'),
('ORD-2024-00011', 'delivered', '2024-11-14 13:00:00', '{"signed_by":"A. Dubois"}'),
('ORD-2024-00012', 'placed',    '2024-11-12 14:50:00', '{"items":1,"total":27.54}'),
('ORD-2024-00012', 'confirmed', '2024-11-12 14:55:00', '{"warehouse":"WH-West"}'),
('ORD-2024-00012', 'shipped',   '2024-11-13 09:15:00', '{"carrier":"FedEx","tracking":"FX100200303"}'),
('ORD-2024-00012', 'delivered', '2024-11-15 10:30:00', '{"signed_by":"H. Tanaka"}'),
('ORD-2024-00013', 'placed',    '2024-11-13 10:30:00', '{"items":1,"total":14.99}'),
('ORD-2024-00013', 'confirmed', '2024-11-13 10:35:00', '{"warehouse":"WH-East"}'),
('ORD-2024-00013', 'shipped',   '2024-11-14 08:00:00', '{"carrier":"DHL","tracking":"DH5001004"}'),
('ORD-2024-00013', 'delivered', '2024-11-16 15:20:00', '{"signed_by":"P. Svensson"}'),
('ORD-2024-00014', 'placed',    '2024-11-14 09:45:00', '{"items":2,"total":36.98}'),
('ORD-2024-00014', 'confirmed', '2024-11-14 09:50:00', '{"warehouse":"WH-East"}'),
('ORD-2024-00014', 'shipped',   '2024-11-15 07:45:00', '{"carrier":"UPS","tracking":"1Z999AA10006"}'),
('ORD-2024-00014', 'delivered', '2024-11-17 12:30:00', '{"signed_by":"K. Nowak"}'),
('ORD-2024-00015', 'placed',    '2024-11-15 16:20:00', '{"items":1,"total":27.99}'),
('ORD-2024-00015', 'confirmed', '2024-11-15 16:25:00', '{"warehouse":"WH-West"}'),
('ORD-2024-00015', 'shipped',   '2024-11-16 09:00:00', '{"carrier":"FedEx","tracking":"FX100200304"}'),
('ORD-2024-00016', 'placed',    '2024-11-16 12:10:00', '{"items":1,"total":10.99}'),
('ORD-2024-00016', 'confirmed', '2024-11-16 12:15:00', '{"warehouse":"WH-East"}'),
('ORD-2024-00016', 'shipped',   '2024-11-17 08:30:00', '{"carrier":"DHL","tracking":"DH5001005"}'),
('ORD-2024-00016', 'delivered', '2024-11-19 14:00:00', '{"signed_by":"F. Bernard"}'),
('ORD-2024-00017', 'placed',    '2024-11-17 08:55:00', '{"items":2,"total":42.98}'),
('ORD-2024-00017', 'confirmed', '2024-11-17 09:00:00', '{"warehouse":"WH-West"}'),
('ORD-2024-00017', 'shipped',   '2024-11-18 07:30:00', '{"carrier":"UPS","tracking":"1Z999AA10007"}'),
('ORD-2024-00017', 'delivered', '2024-11-20 11:45:00', '{"signed_by":"E. Petrov"}'),
('ORD-2024-00018', 'placed',    '2024-11-18 14:35:00', '{"items":1,"total":28.79}'),
('ORD-2024-00018', 'confirmed', '2024-11-18 14:40:00', '{"warehouse":"WH-East"}'),
('ORD-2024-00018', 'shipped',   '2024-11-19 09:00:00', '{"carrier":"FedEx","tracking":"FX100200305"}'),
('ORD-2024-00018', 'delivered', '2024-11-21 16:10:00', '{"signed_by":"V. Santos"}'),
('ORD-2024-00019', 'placed',    '2024-11-19 11:20:00', '{"items":1,"total":13.99}'),
('ORD-2024-00019', 'confirmed', '2024-11-19 11:25:00', '{"warehouse":"WH-East"}'),
('ORD-2024-00019', 'shipped',   '2024-11-20 08:15:00', '{"carrier":"DHL","tracking":"DH5001006"}'),
('ORD-2024-00019', 'delivered', '2024-11-22 13:30:00', '{"signed_by":"I. Kowalski"}'),
('ORD-2024-00020', 'placed',    '2024-11-20 09:00:00', '{"items":1,"total":11.99}'),
('ORD-2024-00020', 'confirmed', '2024-11-20 09:05:00', '{"warehouse":"WH-West"}'),
('ORD-2024-00020', 'shipped',   '2024-11-21 07:45:00', '{"carrier":"UPS","tracking":"1Z999AA10008"}'),
('ORD-2024-00020', 'delivered', '2024-11-23 10:00:00', '{"signed_by":"D. Chen"}'),
('ORD-2024-00021', 'placed',    '2024-11-21 15:45:00', '{"items":1,"total":29.99}'),
('ORD-2024-00021', 'confirmed', '2024-11-21 15:50:00', '{"warehouse":"WH-East"}'),
('ORD-2024-00021', 'shipped',   '2024-11-22 09:00:00', '{"carrier":"FedEx","tracking":"FX100200306"}'),
('ORD-2024-00021', 'delivered', '2024-11-24 14:15:00', '{"signed_by":"B. Fischer"}'),
('ORD-2024-00022', 'placed',    '2024-11-22 10:15:00', '{"items":2,"total":41.49}'),
('ORD-2024-00022', 'confirmed', '2024-11-22 10:20:00', '{"warehouse":"WH-East"}'),
('ORD-2024-00022', 'shipped',   '2024-11-23 08:00:00', '{"carrier":"DHL","tracking":"DH5001007"}'),
('ORD-2024-00022', 'delivered', '2024-11-25 12:30:00', '{"signed_by":"N. Andersen"}'),
('ORD-2024-00023', 'placed',    '2024-11-23 13:40:00', '{"items":1,"total":14.99}'),
('ORD-2024-00023', 'confirmed', '2024-11-23 13:45:00', '{"warehouse":"WH-West"}'),
('ORD-2024-00023', 'shipped',   '2024-11-24 07:30:00', '{"carrier":"UPS","tracking":"1Z999AA10009"}'),
('ORD-2024-00023', 'delivered', '2024-11-26 11:00:00', '{"signed_by":"G. Martinez"}'),
('ORD-2024-00024', 'placed',    '2024-11-24 08:30:00', '{"items":1,"total":26.99}'),
('ORD-2024-00024', 'confirmed', '2024-11-24 08:35:00', '{"warehouse":"WH-East"}'),
('ORD-2024-00024', 'shipped',   '2024-11-25 09:15:00', '{"carrier":"FedEx","tracking":"FX100200307"}'),
('ORD-2024-00025', 'placed',    '2024-11-25 16:10:00', '{"items":1,"total":34.99}'),
('ORD-2024-00025', 'confirmed', '2024-11-25 16:15:00', '{"warehouse":"WH-East"}'),
('ORD-2024-00025', 'shipped',   '2024-11-26 08:00:00', '{"carrier":"DHL","tracking":"DH5001008"}'),
('ORD-2024-00025', 'delivered', '2024-11-28 15:30:00', '{"signed_by":"O. Larsen"}');

-- EU purchase history (30 rows, UC5 PII)
CREATE TABLE orders.eu_purchase_history (
    purchase_id       SERIAL PRIMARY KEY,
    customer_id       INTEGER NOT NULL,
    order_id          VARCHAR(20) NOT NULL,
    shipping_address  TEXT NOT NULL,
    payment_last4     VARCHAR(4) NOT NULL,
    purchase_date     DATE NOT NULL,
    total_amount      NUMERIC(10,2) NOT NULL,
    currency          VARCHAR(3) DEFAULT 'EUR'
);

INSERT INTO orders.eu_purchase_history (customer_id, order_id, shipping_address, payment_last4, purchase_date, total_amount) VALUES
(1,  'EU-2024-0001', 'Hauptstraße 12, 10115 Berlin, DE',        '4231', '2024-10-01', 42.98),
(2,  'EU-2024-0002', '14 Rue de Rivoli, 75001 Paris, FR',       '8877', '2024-10-03', 26.99),
(3,  'EU-2024-0003', 'Calle Mayor 5, 28013 Madrid, ES',         '1122', '2024-10-05', 18.99),
(4,  'EU-2024-0004', 'Via Roma 22, 00184 Roma, IT',             '3344', '2024-10-07', 34.99),
(5,  'EU-2024-0005', 'Keizersgracht 100, 1015 Amsterdam, NL',  '5566', '2024-10-09', 14.99),
(6,  'EU-2024-0006', 'Friedrichstraße 45, 10117 Berlin, DE',   '7788', '2024-10-11', 52.98),
(7,  'EU-2024-0007', '8 Avenue des Champs-Élysées, 75008 Paris, FR', '9900', '2024-10-13', 29.99),
(8,  'EU-2024-0008', 'Paseo de la Castellana 10, 28046 Madrid, ES',  '2233', '2024-10-15', 21.99),
(9,  'EU-2024-0009', 'Corso Vittorio Emanuele 15, 20122 Milano, IT', '4455', '2024-10-17', 38.99),
(10, 'EU-2024-0010', 'Herengracht 50, 1017 Amsterdam, NL',     '6677', '2024-10-19', 16.99),
(11, 'EU-2024-0011', 'Unter den Linden 10, 10117 Berlin, DE',  '8899', '2024-10-21', 45.98),
(12, 'EU-2024-0012', '25 Rue Saint-Honoré, 75001 Paris, FR',   '1010', '2024-10-23', 31.99),
(13, 'EU-2024-0013', 'Gran Via 30, 28013 Madrid, ES',          '2020', '2024-10-25', 24.99),
(14, 'EU-2024-0014', 'Via del Corso 100, 00186 Roma, IT',      '3030', '2024-10-27', 27.99),
(15, 'EU-2024-0015', 'Damrak 1, 1012 Amsterdam, NL',           '4040', '2024-10-29', 19.99),
(1,  'EU-2024-0016', 'Hauptstraße 12, 10115 Berlin, DE',        '4231', '2024-11-01', 36.99),
(2,  'EU-2024-0017', '14 Rue de Rivoli, 75001 Paris, FR',       '8877', '2024-11-03', 22.99),
(3,  'EU-2024-0018', 'Calle Mayor 5, 28013 Madrid, ES',         '1122', '2024-11-05', 44.98),
(16, 'EU-2024-0019', 'Alexanderplatz 3, 10178 Berlin, DE',     '5050', '2024-11-07', 28.99),
(17, 'EU-2024-0020', '5 Place de la Concorde, 75008 Paris, FR','6060', '2024-11-09', 33.99),
(18, 'EU-2024-0021', 'Calle de Alcalá 50, 28014 Madrid, ES',  '7070', '2024-11-11', 17.99),
(19, 'EU-2024-0022', 'Piazza Navona 8, 00186 Roma, IT',        '8080', '2024-11-13', 41.98),
(20, 'EU-2024-0023', 'Prinsengracht 200, 1016 Amsterdam, NL',  '9090', '2024-11-15', 25.99),
(4,  'EU-2024-0024', 'Via Roma 22, 00184 Roma, IT',             '3344', '2024-11-17', 48.98),
(5,  'EU-2024-0025', 'Keizersgracht 100, 1015 Amsterdam, NL',  '5566', '2024-11-19', 20.99),
(6,  'EU-2024-0026', 'Friedrichstraße 45, 10117 Berlin, DE',   '7788', '2024-11-21', 39.99),
(7,  'EU-2024-0027', '8 Avenue des Champs-Élysées, 75008 Paris, FR', '9900', '2024-11-23', 15.99),
(8,  'EU-2024-0028', 'Paseo de la Castellana 10, 28046 Madrid, ES',  '2233', '2024-11-25', 32.99),
(9,  'EU-2024-0029', 'Corso Vittorio Emanuele 15, 20122 Milano, IT', '4455', '2024-11-27', 23.99),
(10, 'EU-2024-0030', 'Herengracht 50, 1017 Amsterdam, NL',     '6677', '2024-11-29', 37.99);
