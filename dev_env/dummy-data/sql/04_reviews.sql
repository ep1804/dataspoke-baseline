-- 04_reviews.sql — UC2: healthy table (user_ratings) and degraded table (user_ratings_legacy).

-- Healthy: rating_score is NOT NULL, ~99.7% completeness
CREATE TABLE reviews.user_ratings (
    rating_id     SERIAL PRIMARY KEY,
    edition_id    INTEGER NOT NULL,
    user_id       VARCHAR(50) NOT NULL,
    rating_score  INTEGER NOT NULL CHECK (rating_score BETWEEN 1 AND 5),
    review_text   TEXT,
    helpful_votes INTEGER DEFAULT 0,
    verified      BOOLEAN DEFAULT FALSE,
    created_at    TIMESTAMP DEFAULT NOW()
);

INSERT INTO reviews.user_ratings (edition_id, user_id, rating_score, review_text, helpful_votes, verified, created_at) VALUES
(1,  'user_101', 5, 'Absolutely gripping from start to finish!',       12, TRUE,  '2023-04-01 10:00:00'),
(1,  'user_102', 4, 'Great thriller, slightly predictable ending.',     8,  TRUE,  '2023-04-15 14:30:00'),
(2,  'user_103', 3, 'Decent paperback quality.',                        2,  FALSE, '2023-10-01 09:00:00'),
(3,  'user_104', 5, 'Best sci-fi I have read this year!',              22, TRUE,  '2023-07-10 11:20:00'),
(4,  'user_105', 4, 'Enjoyed the eBook format.',                        5,  TRUE,  '2023-06-20 16:45:00'),
(5,  'user_106', 4, 'Sweet and well-written romance.',                  7,  FALSE, '2023-02-14 08:00:00'),
(6,  'user_107', 5, 'Audiobook narration was excellent.',              15, TRUE,  '2023-05-01 12:30:00'),
(7,  'user_108', 5, 'Epic fantasy — could not put it down.',           30, TRUE,  '2022-12-25 09:00:00'),
(8,  'user_109', 4, 'Good paperback edition, nice cover art.',          4,  TRUE,  '2023-06-10 10:15:00'),
(9,  'user_110', 3, 'eBook had some formatting issues.',                1,  FALSE, '2022-12-01 14:00:00'),
(10, 'user_111', 5, 'Fascinating history, well researched.',           18, TRUE,  '2023-10-20 08:45:00'),
(11, 'user_112', 4, 'Practical business advice.',                       9,  TRUE,  '2024-02-10 11:30:00'),
(12, 'user_113', 3, 'eBook was okay, not groundbreaking.',              2,  FALSE, '2024-02-15 15:00:00'),
(13, 'user_114', 4, 'Lovely memoir, very inspiring.',                   6,  TRUE,  '2023-08-20 09:30:00'),
(14, 'user_115', 5, 'My kids love this picture book!',                 20, TRUE,  '2023-05-15 07:00:00'),
(15, 'user_116', 4, 'Clear explanations of complex topics.',           11, TRUE,  '2024-03-20 13:00:00'),
(16, 'user_117', 5, 'Perfect intro to physics.',                       14, FALSE, '2024-03-25 10:00:00'),
(17, 'user_118', 3, 'A bit dry in places.',                             3,  TRUE,  '2023-09-10 16:20:00'),
(18, 'user_119', 4, 'Well-organized self-help tips.',                   7,  FALSE, '2023-06-15 08:30:00'),
(19, 'user_120', 5, 'Audiobook was a joy to listen to.',               16, TRUE,  '2023-09-01 12:00:00'),
(20, 'user_121', 5, 'Dragon Codex sequel delivers!',                   25, TRUE,  '2024-04-10 09:00:00'),
(21, 'user_122', 4, 'Charming seaside romance.',                        5,  TRUE,  '2024-02-14 14:00:00'),
(22, 'user_123', 4, 'Good thriller, well-paced.',                       8,  TRUE,  '2024-05-20 11:15:00'),
(23, 'user_124', 3, 'eBook formatting could be better.',                1,  FALSE, '2024-05-25 15:30:00'),
(24, 'user_125', 5, 'Mind-bending sci-fi concept!',                    19, TRUE,  '2024-07-20 08:00:00'),
(25, 'user_126', 5, 'Kids asked me to read it three times.',           13, TRUE,  '2024-03-10 07:30:00'),
(26, 'user_127', 4, 'Solid popular science book.',                      6,  TRUE,  '2024-06-01 10:45:00'),
(27, 'user_128', 4, 'eBook version was very readable.',                 4,  FALSE, '2024-06-05 14:00:00'),
(28, 'user_129', 3, 'Some chapters felt repetitive.',                   2,  TRUE,  '2024-08-15 09:00:00'),
(29, 'user_130', 4, 'Beautiful literary fiction.',                       7,  TRUE,  '2024-09-10 12:30:00'),
(30, 'user_131', 5, 'Fun middle-grade adventure.',                     10, TRUE,  '2024-04-20 08:15:00'),
(31, 'user_132', 5, 'Brilliant exploration of AI.',                    21, TRUE,  '2024-10-05 11:00:00'),
(32, 'user_133', 5, 'Perfect ending to the trilogy.',                  28, TRUE,  '2024-11-20 09:30:00'),
(33, 'user_134', 4, 'eBook was a quick, satisfying read.',              5,  FALSE, '2024-11-25 14:00:00'),
(34, 'user_135', 4, 'Sweet and funny dating app story.',                6,  TRUE,  '2024-12-05 10:00:00'),
(35, 'user_136', 5, 'Edge-of-seat cyber thriller.',                    17, TRUE,  '2025-01-10 08:45:00'),
(36, 'user_137', 4, 'Learned so much about ancient history.',           9,  TRUE,  '2024-07-25 13:00:00'),
(37, 'user_138', 3, 'Good startup advice, not groundbreaking.',         3,  FALSE, '2025-02-10 11:30:00'),
(38, 'user_139', 5, 'Poetic and haunting.',                            12, TRUE,  '2025-03-15 09:00:00'),
(39, 'user_140', 5, 'Adorable space puppies!',                         15, TRUE,  '2025-02-14 07:00:00'),
(40, 'user_141', 4, 'Hardcover quality is superb.',                     4,  TRUE,  '2025-05-01 10:30:00'),
(1,  'user_142', 4, 'Re-read it, still great.',                         3,  TRUE,  '2024-01-10 08:00:00'),
(3,  'user_143', 5, 'Loved the hard sci-fi elements.',                 10, TRUE,  '2023-08-15 14:20:00'),
(7,  'user_144', 4, 'Dragon Codex keeps getting better.',               9,  FALSE, '2023-06-30 11:00:00'),
(10, 'user_145', 4, 'Impressive historical research.',                   6,  TRUE,  '2023-12-01 09:30:00'),
(14, 'user_146', 5, 'A bedtime favorite for my children.',             11, TRUE,  '2023-07-04 07:15:00'),
(20, 'user_147', 4, 'Solid sequel, high expectations met.',             8,  TRUE,  '2024-05-01 10:00:00'),
(24, 'user_148', 5, 'Chen does it again — phenomenal.',                14, TRUE,  '2024-08-10 08:30:00'),
(32, 'user_149', 4, 'eBook was well-formatted.',                        3,  FALSE, '2024-12-15 15:00:00'),
(35, 'user_150', 5, 'Cannot wait for the next Vasquez book.',          20, TRUE,  '2025-02-01 09:00:00');

-- Degraded: ~30% NULL rating_score (15 out of 50 rows)
CREATE TABLE reviews.user_ratings_legacy (
    rating_id     SERIAL PRIMARY KEY,
    edition_id    INTEGER NOT NULL,
    user_id       VARCHAR(50) NOT NULL,
    rating_score  INTEGER CHECK (rating_score BETWEEN 1 AND 5),  -- NULLable!
    review_text   TEXT,
    helpful_votes INTEGER DEFAULT 0,
    verified      BOOLEAN DEFAULT FALSE,
    created_at    TIMESTAMP DEFAULT NOW()
);

INSERT INTO reviews.user_ratings_legacy (edition_id, user_id, rating_score, review_text, helpful_votes, verified, created_at) VALUES
(1,  'user_201', 5,    'Loved it!',                              10, TRUE,  '2022-06-01 10:00:00'),
(1,  'user_202', NULL, 'Good book.',                              2, FALSE, '2022-06-15 11:00:00'),
(2,  'user_203', 4,    'Nice paperback.',                         3, TRUE,  '2022-07-01 09:00:00'),
(3,  'user_204', NULL, NULL,                                      0, FALSE, '2022-07-10 14:00:00'),
(4,  'user_205', 5,    'Incredible eBook experience.',            15, TRUE,  '2022-08-01 08:30:00'),
(5,  'user_206', 3,    'Decent romance novel.',                    4, FALSE, '2022-08-15 12:00:00'),
(6,  'user_207', NULL, 'Listened to the audiobook.',               1, TRUE,  '2022-09-01 10:30:00'),
(7,  'user_208', 5,    'Best fantasy series.',                    20, TRUE,  '2022-09-15 09:00:00'),
(8,  'user_209', 4,    'Solid paperback.',                         5, TRUE,  '2022-10-01 11:00:00'),
(9,  'user_210', NULL, NULL,                                      0, FALSE, '2022-10-15 14:30:00'),
(10, 'user_211', 4,    'Great historical writing.',                7, TRUE,  '2022-11-01 08:00:00'),
(11, 'user_212', NULL, 'Useful business book.',                    2, FALSE, '2022-11-15 10:00:00'),
(12, 'user_213', 3,    'eBook was fine.',                          1, FALSE, '2022-12-01 09:30:00'),
(13, 'user_214', 4,    'Inspiring memoir.',                        6, TRUE,  '2022-12-15 12:00:00'),
(14, 'user_215', NULL, 'Kids enjoyed it.',                         3, TRUE,  '2023-01-01 07:00:00'),
(15, 'user_216', 5,    'Made physics accessible.',                11, TRUE,  '2023-01-15 10:00:00'),
(16, 'user_217', NULL, NULL,                                      0, FALSE, '2023-02-01 14:00:00'),
(17, 'user_218', 3,    'Okay literary fiction.',                   2, TRUE,  '2023-02-15 09:00:00'),
(18, 'user_219', 4,    'Helpful self-improvement tips.',           5, FALSE, '2023-03-01 11:30:00'),
(19, 'user_220', NULL, 'Good audiobook.',                          1, TRUE,  '2023-03-15 08:00:00'),
(20, 'user_221', 5,    'Fantasy at its finest.',                  18, TRUE,  '2023-04-01 09:00:00'),
(21, 'user_222', NULL, NULL,                                      0, FALSE, '2023-04-15 14:00:00'),
(22, 'user_223', 4,    'Thriller kept me guessing.',               8, TRUE,  '2023-05-01 10:00:00'),
(23, 'user_224', NULL, 'Quick read.',                              1, FALSE, '2023-05-15 12:00:00'),
(24, 'user_225', 5,    'Amazing sci-fi concepts.',                14, TRUE,  '2023-06-01 08:30:00'),
(25, 'user_226', 4,    'Cute picture book.',                       6, TRUE,  '2023-06-15 07:00:00'),
(26, 'user_227', NULL, NULL,                                      0, FALSE, '2023-07-01 10:00:00'),
(27, 'user_228', 3,    'Average eBook quality.',                   2, FALSE, '2023-07-15 14:30:00'),
(28, 'user_229', 4,    'Good business insights.',                  5, TRUE,  '2023-08-01 09:00:00'),
(29, 'user_230', NULL, 'Beautiful prose.',                         3, TRUE,  '2023-08-15 11:00:00'),
(30, 'user_231', 5,    'Fun adventure for kids.',                 10, TRUE,  '2023-09-01 08:00:00'),
(31, 'user_232', 4,    'Well-written AI book.',                    7, TRUE,  '2023-09-15 10:30:00'),
(32, 'user_233', NULL, NULL,                                      0, FALSE, '2023-10-01 14:00:00'),
(33, 'user_234', 5,    'Trilogy conclusion was epic.',            22, TRUE,  '2023-10-15 09:00:00'),
(34, 'user_235', NULL, 'Romantic comedy vibes.',                   2, FALSE, '2023-11-01 12:00:00'),
(35, 'user_236', 4,    'Good cyber thriller.',                     8, TRUE,  '2023-11-15 10:00:00'),
(36, 'user_237', 3,    'Dense historical work.',                   3, TRUE,  '2023-12-01 08:00:00'),
(37, 'user_238', NULL, NULL,                                      0, FALSE, '2023-12-15 14:30:00'),
(38, 'user_239', 5,    'Haunting and beautiful.',                 12, TRUE,  '2024-01-01 09:00:00'),
(39, 'user_240', 4,    'Adorable illustrations.',                  6, TRUE,  '2024-01-15 07:30:00'),
(40, 'user_241', NULL, 'Nice hardcover.',                          1, FALSE, '2024-02-01 10:00:00'),
(1,  'user_242', 4,    'Still holds up on re-read.',               4, TRUE,  '2024-02-15 08:00:00'),
(3,  'user_243', 5,    'Sci-fi masterpiece.',                     11, TRUE,  '2024-03-01 11:00:00'),
(7,  'user_244', 4,    'Dragon Codex never disappoints.',          9, FALSE, '2024-03-15 09:30:00'),
(10, 'user_245', 3,    'Interesting but long.',                    2, TRUE,  '2024-04-01 14:00:00'),
(14, 'user_246', 5,    'Bedtime story staple.',                   13, TRUE,  '2024-04-15 07:00:00'),
(20, 'user_247', NULL, 'Good sequel.',                             3, TRUE,  '2024-05-01 10:00:00'),
(24, 'user_248', 5,    'Chen is a genius.',                       16, TRUE,  '2024-05-15 08:30:00'),
(32, 'user_249', 4,    'Solid eBook version.',                     5, FALSE, '2024-06-01 12:00:00'),
(35, 'user_250', 5,    'Vasquez at her best.',                    19, TRUE,  '2024-06-15 09:00:00');
